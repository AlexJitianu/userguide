<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task
  PUBLIC "-//OASIS//DTD DITA Task//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/task.dtd">
<task id="install-license-server-as-windows-service">
  <title>Install the License Server as a Windows Service</title>
  <prolog>
    <metadata>
      <keywords><indexterm>License<indexterm>license server installed as Windows
          service</indexterm></indexterm></keywords>
    </metadata>
  </prolog>
  <taskbody>
    <steps>
      <step>
        <cmd>Ensure that a up-to-date version of Java is installed on the server machine and that
          the JAVA_HOME variable points to the location Java is
          installed.<?oxy_comment_start author="Mark" timestamp="20140730T165706-0400" comment="Is JAVA_HOME the only method that works in this case. In other cases, various methods for finding Java are listed. "?></cmd>
        <?oxy_comment_end?>
      </step>
      <step>
        <cmd>Add <ph>oXygenLicenseServer.exe</ph> manually in the Windows Firewall list of
          exceptions. Go to <menucascade>
            <uicontrol>Control Panel</uicontrol>
            <uicontrol>System and Security</uicontrol>
            <uicontrol>Windows Firewall</uicontrol>
            <uicontrol>Allow a program or feature through Windows Firewall</uicontrol>
            <uicontrol> Allow another program</uicontrol>
          </menucascade> and browse for <ph>oXygenLicenseServer.exe</ph> from the <ph
            keyref="product"/> License Server installation folder.</cmd>
      </step>
      <step>
        <cmd>Download the Windows installer of the license server from the URL provided in the
          registration email message containing your floating license key.</cmd>
      </step>
      <step>
        <cmd>Run the downloaded installer.</cmd>
      </step>

      <step>
        <cmd>Enable the Windows service on the machine that hosts the license server, either during
          installation or at a later time with the service management batch scripts
            (<i>installWindowsService.bat</i>).</cmd>
        <info>
          <p>If you want to manually install, start, stop, or uninstall  the server as a Windows
            service, run the following scripts from command line. On Windows Vista
            and<?oxy_comment_start author="Mark" timestamp="20140730T165610-0400" comment="What about windows 8?"?>
            Windows 7 <?oxy_comment_end?>you have to run the commands as Administrator.</p>
          <ul>
            <li><filepath>installWindowsService.bat [serviceName]</filepath> - install the server as
              a Windows service with the name <i>serviceName</i>. The parameters for the license key
              folder and the server port can be set in the
                <filepath>oXygenLicenseServer.vmoptions</filepath> file. </li>
            <li><filepath>startWindowsService.bat [serviceName]</filepath> - start the Windows
              service.</li>
            <li><filepath>stopWindowsService.bat [serviceName]</filepath> - stop the Windows
              service.</li>
            <li><filepath>uninstallWindowsService.bat [serviceName]</filepath> - uninstall the
              Windows service.</li>
          </ul>
          <note>If you do not provide the <i>serviceName</i> argument, the default name,
              <i>oXygenLicenseServer</i>, is used. </note>
        </info>
      </step>
    </steps>
    <result>
      <p>When the license server is used as a Windows service, the output and error messages are
        redirected automatically to the following log files created in the install folder:</p>
      <ul>
        <li><filepath>outLicenseServer.log</filepath> - server's standard output stream;</li>
        <li><filepath>errLicenseServer.log</filepath> - server's standard error stream.</li>
      </ul>
      <note>On Windows Vista and Windows 7 if you want to start or stop the Windows service with the
        Start menu shortcut called <i>Start Windows service</i> / <i>Stop Windows service</i> you
        have to run the shortcut as Administrator.</note>
    </result>
  </taskbody>
</task>
